<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SAE5_IHM: Référence du fichier D:/Scolarite/IUT/BUT GEII/Semestre_5/INFO5/SAE5/Code_Final/M5_Stamp/src/main.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SAE5_IHM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.13.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Recherche',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Chargement...</div>
<div class="SRStatus" id="Searching">Recherche...</div>
<div class="SRStatus" id="NoMatches">Aucune correspondance</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_62d0ee649ccdb4c73473bbb90b970d01.html">M5_Stamp</a></li><li class="navelem"><a class="el" href="dir_8bd3a88ef3fe5668c1b5f0ba8e313261.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Fonctions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Référence du fichier main.cpp<div class="ingroups"><a class="el" href="group___m5___stamp.html">M5_Stamp</a> &raquo; <a class="el" href="group___m5___stamp___main.html">M5_Stamp_Main</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Ce code permet de faire la simulation d'ajout d'un M5 Stamp sur un M5 Core 2. Pour faire cela le Stamp va d'abord chercher à trouver le M5 Core avec le nom voulu, dans notre cas "M5Core2". Quand il est trouvé la LED du Stamp passe de Bleue à Blanc.  
<a href="#details">Plus de détails...</a></p>
<div class="textblock"><code>#include &quot;project.h&quot;</code><br />
<code>#include &lt;M5StampC3LED.h&gt;</code><br />
</div>
<p><a href="_m5___stamp_2src_2main_8cpp_source.html">Aller au code source de ce fichier.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Fonctions</h2></td></tr>
<tr class="memitem:ga4fc01d736fe50cf5b977f755b675f11d" id="r_ga4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m5___stamp___main.html#ga4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="separator:ga4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe461d27b9c48d5921c00d521181f12f" id="r_gafe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m5___stamp___main.html#gafe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="separator:gafe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae31151ced913bcc81fa0ff026b9e15ad" id="r_gae31151ced913bcc81fa0ff026b9e15ad"><td class="memItemLeft" align="right" valign="top">BLEDevice&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m5___stamp___main.html#gae31151ced913bcc81fa0ff026b9e15ad">scanForDevice</a> (const char *targetName)</td></tr>
<tr class="memdesc:gae31151ced913bcc81fa0ff026b9e15ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recherche un périphérique BLE avec un nom cible spécifique.  <br /></td></tr>
<tr class="separator:gae31151ced913bcc81fa0ff026b9e15ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4ae56307d6dc370e3024e13790154ce" id="r_gae4ae56307d6dc370e3024e13790154ce"><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m5___stamp___main.html#gae4ae56307d6dc370e3024e13790154ce">generateRandomUID</a> ()</td></tr>
<tr class="memdesc:gae4ae56307d6dc370e3024e13790154ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Génère un identifiant UID aléatoire au format "XX:XX:XX:XX:XX:XX".  <br /></td></tr>
<tr class="separator:gae4ae56307d6dc370e3024e13790154ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacace77038abf3e7690f8d7cd6403cc5a" id="r_gacace77038abf3e7690f8d7cd6403cc5a"><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m5___stamp___main.html#gacace77038abf3e7690f8d7cd6403cc5a">generateRandomRoomName</a> ()</td></tr>
<tr class="memdesc:gacace77038abf3e7690f8d7cd6403cc5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Génère un nom de pièce aléatoire en sélectionnant un élément dans une liste préexistante.  <br /></td></tr>
<tr class="separator:gacace77038abf3e7690f8d7cd6403cc5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf8cfccb0c5c6c274999ad44fff1efe6a" id="r_gaf8cfccb0c5c6c274999ad44fff1efe6a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m5___stamp___main.html#gaf8cfccb0c5c6c274999ad44fff1efe6a">generateRandomDeviceType</a> ()</td></tr>
<tr class="memdesc:gaf8cfccb0c5c6c274999ad44fff1efe6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Génère un type d'appareil aléatoire (idTypeDevice) compris entre 1 et 5.  <br /></td></tr>
<tr class="separator:gaf8cfccb0c5c6c274999ad44fff1efe6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga5abdb68d9777f2a386b2f8cfeb095a6b" id="r_ga5abdb68d9777f2a386b2f8cfeb095a6b"><td class="memItemLeft" align="right" valign="top">M5StampC3LED&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m5___stamp___main.html#ga5abdb68d9777f2a386b2f8cfeb095a6b">led</a> = M5StampC3LED()</td></tr>
<tr class="memdesc:ga5abdb68d9777f2a386b2f8cfeb095a6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation de la LED du M5 Stamp.  <br /></td></tr>
<tr class="separator:ga5abdb68d9777f2a386b2f8cfeb095a6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabea6c6d8de559e3e013f39b69c531d01" id="r_gabea6c6d8de559e3e013f39b69c531d01"><td class="memItemLeft" align="right" valign="top">const String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m5___stamp___main.html#gabea6c6d8de559e3e013f39b69c531d01">roomNames</a> [] = {&quot;Salon&quot;, &quot;Cuisine&quot;, &quot;Chambre&quot;, &quot;Salle de bain&quot;, &quot;Bureau&quot;, &quot;Entree&quot;}</td></tr>
<tr class="memdesc:gabea6c6d8de559e3e013f39b69c531d01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Liste des pièces de la maison.  <br /></td></tr>
<tr class="separator:gabea6c6d8de559e3e013f39b69c531d01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac88aec921fc38cf370334c0254f7f679" id="r_gac88aec921fc38cf370334c0254f7f679"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m5___stamp___main.html#gac88aec921fc38cf370334c0254f7f679">numRooms</a> = sizeof(<a class="el" href="group___m5___stamp___main.html#gabea6c6d8de559e3e013f39b69c531d01">roomNames</a>) / sizeof(<a class="el" href="group___m5___stamp___main.html#gabea6c6d8de559e3e013f39b69c531d01">roomNames</a>[0])</td></tr>
<tr class="memdesc:gac88aec921fc38cf370334c0254f7f679"><td class="mdescLeft">&#160;</td><td class="mdescRight">Taille de la liste.  <br /></td></tr>
<tr class="separator:gac88aec921fc38cf370334c0254f7f679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca2215cd7e1a452faa882328d911a992" id="r_gaca2215cd7e1a452faa882328d911a992"><td class="memItemLeft" align="right" valign="top">BLEDevice&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m5___stamp___main.html#gaca2215cd7e1a452faa882328d911a992">central</a></td></tr>
<tr class="memdesc:gaca2215cd7e1a452faa882328d911a992"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appareil Bluetooth principal.  <br /></td></tr>
<tr class="separator:gaca2215cd7e1a452faa882328d911a992"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description détaillée</h2>
<div class="textblock"><p>Ce code permet de faire la simulation d'ajout d'un M5 Stamp sur un M5 Core 2. Pour faire cela le Stamp va d'abord chercher à trouver le M5 Core avec le nom voulu, dans notre cas "M5Core2". Quand il est trouvé la LED du Stamp passe de Bleue à Blanc. </p>
<p>Ensuite l'utilisateur peut appuyer sur le bouton du Stamp. La LED passe alors en rose et le Stamp va chercher à se connecter au M5 Core pour lui envoyer une trame. La trame est générée aléatoirement permettant de faire des tests dans diverses situations. Par exemple cette trame :</p>
<ul>
<li>"{\"action\":2,\"idDevice\":1,\"idTypeDevice\":1,\"uid\":\"AA:BB:CC:DD:EE:FF\",\"nom\":\"Chambre\"}"</li>
</ul>
<p>La trame a comme action la 2, donc l'ajout d'un appareil inconu. L'id du type l'appareil, mais aussi sont UID qui est généré aléatoirement et pour finir le nom qui est pris dans une liste roomNames.</p>
<p>Le Stamp va ensuite attendre pendant 60 secondes que le M5 Core, lui renvoie une trame qui valide son ajout ou le refuse. La trame qui doit être réceptionnée est de la forme {"action":3,"info":"x"} avec x qui est soit "valid" ou "denied". Selon la réception la led va passer en vert ou en rouge pendant 5 secondes. Suite à cela le M5 Stamp se déconnecte pour rélancer une nouvelle boucle (la LED passe en bleu). <br  />
</p>
<p>Maintenance: Au niveau de la maintenance du code, il y a plusieurs options qui permettent de traiter tout problème obtenue:</p>
<ul>
<li>Notament le DEBUG_MODE qui permet d'activer ou de désactiver la communication Série qui permet le renvoie de toutes les actions éffectuées par le M5Stamp.</li>
<li>Il y a aussi le BLE_MODE qui permet d'activer ou désactiver la communication BLE et donc de choisir de tester si un problème survient à cause de la communication BLE.</li>
</ul>
<p>Environnement: M5 Stamp C3U</p>
<p>Librairie: ArduinoBLE M5StampC3LED</p>
<dl class="section author"><dt>Auteur</dt><dd>Bartholin Matthieu, Marjorie Koehl, Lucas Lapoirière </dd></dl>
<dl class="section date"><dt>Date</dt><dd>02/01/2025 </dd></dl>

<p class="definition">Définition dans le fichier <a class="el" href="_m5___stamp_2src_2main_8cpp_source.html">main.cpp</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré par&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
